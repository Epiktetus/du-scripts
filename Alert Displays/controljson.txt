{"slots":{"0":{"name":"ControlScreen","type":{"events":[],"methods":[]}},"1":{"name":"slot2","type":{"events":[],"methods":[]}},"2":{"name":"slot3","type":{"events":[],"methods":[]}},"3":{"name":"slot4","type":{"events":[],"methods":[]}},"4":{"name":"slot5","type":{"events":[],"methods":[]}},"5":{"name":"slot6","type":{"events":[],"methods":[]}},"6":{"name":"slot7","type":{"events":[],"methods":[]}},"7":{"name":"slot8","type":{"events":[],"methods":[]}},"8":{"name":"slot9","type":{"events":[],"methods":[]}},"9":{"name":"slot10","type":{"events":[],"methods":[]}},"-1":{"name":"unit","type":{"events":[],"methods":[]}},"-2":{"name":"system","type":{"events":[],"methods":[]}},"-3":{"name":"library","type":{"events":[],"methods":[]}}},"handlers":[{"code":"screenTouched(x,y)","filter":{"args":[{"variable":"*"},{"variable":"*"}],"signature":"mouseUp(x,y)","slotKey":"0"},"key":"0"},{"code":"ChildScreenCount = 0\nChildScreens = findScreens()\nDB = findDB()\nif DB == 0 then\n    system.print(\"connect a DataBank for more than 9 screens\")\nend\n\nif ChildScreenCount == 0 then\n    system.print(\"Connect screens before starting\")\n    unit.exit()\nend\n    system.print(\"Found \" .. ChildScreenCount .. \" screens\")\n\nfor i = 1, ChildScreenCount do\n    ChildScreens[i].activate()\n    ChildScreens[i].clear()\nend\n\nControlScreen.activate()\nControlScreen.clear()\nControlScreen.addContent(0, 0, boxHTML(\"White\", \"Clear Alert\",false))\nGreenBox = ControlScreen.addContent(50, 0, boxHTML(\"Green\", \"Green Alert\",false))\nYellowBox = ControlScreen.addContent(0, 50, boxHTML(\"Yellow\", \"Yellow Alert\",false))\nRedBox = ControlScreen.addContent(50, 50, boxHTML(\"Red\", \"Red Alert\",false))","filter":{"args":[],"signature":"start()","slotKey":"-1"},"key":"1"},{"code":"updateScreens(\"\")\nControlScreen.clear()","filter":{"args":[],"signature":"stop()","slotKey":"-1"},"key":"2"},{"code":"function findDB()\n    for key, value in pairs(unit) do\n        if type(value) == \"table\" and type(value.export) == \"table\" then\n            if value.getElementClass then\n                if value.getElementClass() == \"DataBankUnit\" then\n                    return value\n                end\n            end\n        end\n    end\n    return 0\nend\n\nfunction findScreens()\n    local screens = {}\n    for key, value in pairs(unit) do\n        if type(value) == \"table\" and type(value.export) == \"table\" then\n            if value.getElementClass then\n                if value.getElementClass() == \"ScreenUnit\" then\n                    if value == ControlScreen then\n                        system.print(\"Skipping Control Screen\")\n                    else\n                        ChildScreenCount = ChildScreenCount + 1\n                        table.insert(screens, value)\n                    end\n                end\n            end\n        end\n    end\n    return screens\nend\n\nfunction updateScreens(text)\n    for i = 1, ChildScreenCount do\n        ChildScreens[i].setCenteredText(text)\n    end\n    DB.setStringValue(\"CurrentAlert\",text)\nend\n\nfunction updateScreensFancy(color,text)\n    html=[[\n        <style>\n            @keyframes pulse {\n                from {font-size:10vw}\n                to {font-size:18vw}\n            }\n        </style>\n        <div class=\"bootstrap\" style=\"\n        animation-name:pulse;\n        animation-duration:1s;\n        animation-iteration-count: infinite; \n        animation-direction: alternate;\n        color:]]..color..[[\">\n        ]]..text..[[</div>\n        ]]\n    for i = 1, ChildScreenCount do\n        ChildScreens[i].setHTML(html)\n    end\n    DB.setStringValue(\"CurrentAlert\",html)\nend\n\nfunction screenTouched(x, y)\n    if x < .50 and y < .50 then\n        updateScreens(\"\")\n        ControlScreen.resetContent(GreenBox, boxHTML(\"Green\", \"Green Alert\",false))\n        ControlScreen.resetContent(YellowBox, boxHTML(\"Yellow\", \"Yellow Alert\",false))\n        ControlScreen.resetContent(RedBox, boxHTML(\"Red\", \"Red Alert\",false))\n    end\n    if x > .50 and y < .50 then\n        updateScreensFancy(\"Green\",\"Green<br>Alert\")\n        ControlScreen.resetContent(GreenBox, boxHTML(\"Green\", \"Green Alert\",true))\n        ControlScreen.resetContent(YellowBox, boxHTML(\"Yellow\", \"Yellow Alert\",false))\n        ControlScreen.resetContent(RedBox, boxHTML(\"Red\", \"Red Alert\",false))\n    end\n    if x < .50 and y > .50 then\n        updateScreensFancy(\"Yellow\",\"Yellow<br>Alert\")\n        ControlScreen.resetContent(GreenBox, boxHTML(\"Green\", \"Green Alert\",false))\n        ControlScreen.resetContent(YellowBox, boxHTML(\"Yellow\", \"Yellow Alert\",true))\n        ControlScreen.resetContent(RedBox, boxHTML(\"Red\", \"Red Alert\",false))\n    end\n    if x > .50 and y > .50 then\n        updateScreensFancy(\"Red\",\"Red<br>Alert\")\n        ControlScreen.resetContent(GreenBox, boxHTML(\"Green\", \"Green Alert\",false))\n        ControlScreen.resetContent(YellowBox, boxHTML(\"Yellow\", \"Yellow Alert\",false))\n        ControlScreen.resetContent(RedBox, boxHTML(\"Red\", \"Red Alert\",true))\n    end\nend\n\nfunction boxHTML(color, text, active)\n    if active then\n        border = \"border:2vw solid;\"\n    else\n        border = \"border:0.5vw solid;\"\n    end\n    style = \"font-size:10vw;width:50vw;height:30vw;\"\n    style = style .. \"color:\" .. color .. \";\"\n    style = style .. border\n    html = [[\n        <div style=\"]] .. style .. [[\">\n        ]] .. text .. [[\n        </div>\n    ]]\n    return html\nend\n","filter":{"args":[],"signature":"start()","slotKey":"-3"},"key":"3"}],"methods":[],"events":[]}